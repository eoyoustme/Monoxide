-- Gọi Spawner
local Spawner = loadstring(game:HttpGet('https://raw.githubusercontent.com/MuhXd/DoorSuff/main/OtherSuff/DoorEntitySpawn%2BSource'))()

-- Tạo thực thể
local entity = Spawner.createEntity({
    CustomName = "G-95",
    Model = "rbxassetid://78561638840681",
    Speed = 525,
    DelayTime = 9,
    HeightOffset = 4,
    CanKill = true,
    KillRange = 40,
    DieOnLook = false,
    BreakLights = true,
    FlickerLights = { true, 4 },
    Cycles = { Min = 1, Max = 1, WaitTime = 0.5 },
    CamShake = {
        true,
        {3.5, 20, 0.1, 1},
        100,
    },
    Jumpscare = { false }, -- Jumpscare riêng xử lý bằng local script
    Color = 'GuidingLight'
})

-- Chạy entity
Spawner.runEntity(entity)

-- LOCAL jumpscare logic
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local player = Players.LocalPlayer
local camera = workspace.CurrentCamera

local entityPart = nil
local triggered = false
local killRange = entity.Config.KillRange or 40

-- Tìm entityPart khi entity spawn
task.spawn(function()
    while not entityPart do
        local g95 = workspace:FindFirstChild("G-95")
        if g95 and g95:FindFirstChild("Main") then
            entityPart = g95.Main
            print("Entity part found!")
        end
        task.wait(0.1)
    end
end)

-- Jumpscare logic
RunService.Heartbeat:Connect(function()
    if triggered or not entityPart then return end
    if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then return end

    local dist = (player.Character.HumanoidRootPart.Position - entityPart.Position).Magnitude

    if dist <= killRange then
        triggered = true

        -- Dừng entity bằng cách anchor part chính
        entityPart.Anchored = true

        -- Khóa camera
        camera.CameraType = Enum.CameraType.Scriptable
        local look = CFrame.new(player.Character.Head.Position, entityPart.Position)
        camera.CFrame = look
        TweenService:Create(camera, TweenInfo.new(0.5), {CFrame = look}):Play()

        -- Đợi 1 giây rồi hiện jumpscare
        task.wait(1)

        local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
        gui.Name = "G95Jumpscare"
        local img = Instance.new("ImageLabel", gui)
        img.Size = UDim2.new(1, 0, 1, 0)
        img.Position = UDim2.new(0, 0, 0, 0)
        img.BackgroundTransparency = 1
        img.Image = "rbxassetid://14865476959" -- Thay bằng hình ảnh jumpscare
        img.ImageTransparency = 1
        TweenService:Create(img, TweenInfo.new(0.25), {ImageTransparency = 0}):Play()

        -- Phát âm thanh
        local sound = Instance.new("Sound", workspace)
        sound.SoundId = "rbxassetid://6567183465"
        sound.Volume = 3
        sound:Play()

        task.wait(0.5)

        -- Kill player
        if player.Character and player.Character:FindFirstChild("Humanoid") then
            player.Character.Humanoid.Health = 0
        end
    end
end)
